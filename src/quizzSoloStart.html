<html>

<head>
    <meta charset="utf-8">
    <link href="css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<div id="counter" align="center"></div>
<div id="div" align="center"></div>
<div id="reponse" class="alert alert-danger" style=" display: none" align="center"></div>


<script>

    fetch('http://localhost:3000/questions', {
        method: 'GET'

    }).then(response => response.json())
        .then(json => afficheQuestion(json))
        .catch(function (err) {
            console.log("il y a eu un problème avec l'opération fetch : " + err.message);
        });


    function afficheQuestion(arg) {

        let body = document.getElementsByTagName("body");

        for (i = 0; i < arg.length; i++) {

            div = document.createElement("div");
            div.setAttribute("align", "center");

            question = document.createElement("div");

            question.innerText = arg[i].name;
            question.setAttribute("class", "h1");
            div.appendChild(question);

            document.body.appendChild(div);
        }

    }

    function counter() {
        let cpt = 10;

        divCounter = document.getElementById("counter");
        divCounter.setAttribute("class", "h1");
        divCounter.innerText = cpt + "";
        document.body.appendChild(divCounter);
        setInterval(function () {
            --cpt;
            if (cpt > -1) {
                divCounter.innerText = cpt + '';
            } else {

                console.log("c'est fini");

                reponseDiv = document.getElementById("reponse");
                reponseDiv.innerText = "Temps expiré";
                reponseDiv.style.display = "block";
                document.body.appendChild(reponseDiv);
                clearInterval();

            }
        }, 1000);


    }

    counter();
</script>
</body>
</html>